# Story 12-2: 全局语音设置界面

> Epic: Epic 12: 语音消息能力
> Priority: High
> Points: 5

## 概述
本 Story 负责在系统的“设置”对话框中新增“语音设置”模块。用户在此配置阿里云百炼的 TTS 服务，包括 API Key 和默认音色。这是使用语音功能的前提。

## 用户故事

### US-1: 配置语音服务
**作为** 用户，
**我希望** 在设置界面找到“语音设置”页面，并输入我的阿里云 API Key，
**以便** 开启语音合成能力。

### US-2: 选择默认音色
**作为** 用户，
**我希望** 能试听并选择一个默认音色，
**以便** 当好友未单独配置音色时，使用该默认音色进行回复。

### US-3: 测试配置
**作为** 用户，
**我希望** 点击“测试”按钮来验证我的 API Key 和网络连接是否正常，
**以便** 确保语音服务可用。

## 功能范围

### 包含
-   **设置界面新增 Tab**：在“向量化设置”之后增加“语音设置”。
-   **配置项**：
    -   语音服务商：固定显示“阿里云百炼”。
    -   TTS 模型：固定显示/选择 `qwen3-tts-instruct-flash`（目前仅支持此模型）。
    -   API Key：输入框（掩码显示，支持明文查看）。
    -   默认音色：下拉选择框，展示音色名称和头像（若有），支持点击播放预览音频。
-   **测试功能**：点击“测试”，后端调用阿里云 TTS 接口合成一段简短文本（如“你好，我是 WeAgentChat”），前端播放返回的音频。
-   **数据持久化**：保存配置到 `system_settings` 表。

### 不包含
-   多 TTS 服务商支持（目前仅阿里云）。
-   复杂的音频参数调节（语速、音调等，暂使用默认值）。

## 验收标准

- [ ] AC-1: 设置弹窗中出现“语音设置”Tab，布局与 LLM 设置保持一致。
- [ ] AC-2: 用户可以输入 API Key 并保存。
- [ ] AC-3: 音色下拉框加载 Story 12-1 提供的音色列表，每项包含“播放”小图标，点击可试听。
- [ ] AC-4: 点击“测试配置”按钮，系统提示“测试中...”，成功后自动播放一段合成语音并提示“测试成功”，失败则提示具体错误信息。
- [ ] AC-5: 设置的 API Key 必须能正确用于后续的 TTS 调用。

## 依赖关系

### 前置依赖
- Story 12-1: 语音音色库与数据库设计 (提供音色数据)

### 被依赖（后续）
- Story 12-3: 好友语音个性化配置 (依赖全局配置检查)
