# Story 11-01: 聊天记录图片导出 (小红书风格)

## 1. 用户故事 (User Story)

**作为一个** 唯信 (DouDouChat) 用户，
**我想要** 将单聊或群聊中的精彩对话片段导出为美观的图片（适配小红书 3:4 比例），
**以便于** 我可以将有意思的 AI 互动内容分享到社交媒体。

## 2. 验收标准 (Acceptance Criteria)

### AC1: 导出入口与交互
- [ ] 在单聊和群聊界面的工具栏或“更多”菜单中，应有一个“分享/导出”按钮。
- [ ] 点击按钮后，聊天界面进入“选择模式”：
    - [ ]每条消息旁出现复选框。
    - [ ] 底部出现操作栏，包含“取消”、“生成图片”按钮和“已选条数”提示。
- [ ] 支持点击复选框选择多条不连续的消息（生成时按时间顺序排列）。

### AC2: 图片生成预览
- [ ] 点击“生成图片”后，弹出一个模态框展示预览图。
- [ ] 默认生成样式需适配小红书：
    - [ ] **纵横比**：强制或优先保持 3:4。
    - [ ] **样式**：背景色应美观（如渐变或纯净磨砂），消息气泡布局清晰。
    - [ ] **水印**：图片底部或角落需包含“WeAgentChat / 唯信”品牌标识。
- [ ] **分页处理**：
    - [ ] 如果选中的内容过长，超过一张 3:4 图片的容量，应自动分割为多张图片。
    - [ ] 预览界面应该支持左右切换查看所有生成的图片页。

### AC3: 保存功能
- [ ] 预览界面需提供“保存全部”或“保存当前页”按钮。
- [ ] 点击保存后，图片应下载到本地设备（格式建议为 PNG 或 JPG）。

### AC4: 性能与约束
- [ ] 生成过程在纯前端完成，无需调用后端接口。
- [ ] 生成过程中应有 Loading 提示，避免界面假死。
- [ ] 图片清晰度需适配高分辨率屏幕（建议 2x 或 3x 渲染）。

## 3. UI/UX 设计思路

1.  **选择模式**：
    *   参考微信的“多选”交互。
    *   消息体变暗或右移，左侧滑出空心圆圈供勾选。
2.  **生成预览**：
    *   弹窗居中显示手机形状的预览容器（3:4 比例）。
    *   容器内显示渲染后的聊天列表快照。
    *   容器底部为固定 Footer（包含 Logo/Slogan）。
    *   如果有多张，显示“1/3”页码指示器和左右翻页箭头。

## 4. 技术方案参考 (Technical Notes)

-   **核心库**：建议使用 `modern-screenshot`（比 html2canvas 更现代、Bug 更少）或 `html2canvas`。
-   **实现逻辑**：
    1.  克隆选中的 DOM 节点到一个隐藏的容器中。
    2.  为该容器应用特定的“分享模式”样式（更宽的 Padding，更大的字体，隐藏无关元素）。
    3.  根据容器高度和 3:4 比例计算分页切割点。
    4.  调用截图库将 DOM 转换为 Blob/DataURL。
-   **数据脱敏**：注意即使是纯前端，也需确保生成的图片不包含不应显示的系统调试信息。

## 5. 依赖关系

-   依赖于 `MessageList` 组件的现有结构。
-   属于 `Epic-01` (基础聊天界面) 的增强功能。


## 6. 实施路径

- 第一阶段：群聊记录图片导出
- 第二阶段：单聊记录图片导出